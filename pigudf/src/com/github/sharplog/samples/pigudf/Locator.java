package com.github.sharplog.samples.pigudf;

/**
 * 根据传进来的地点字符串，判断这个地点是哪个省级单位。
 * 如果判断不出来，就返回null。
 */

import java.io.IOException;
import java.util.HashMap;
import java.util.Map;

import org.apache.pig.EvalFunc;
import org.apache.pig.data.Tuple;

public class Locator extends EvalFunc<String> {

	@Override
	public String exec(Tuple arg) throws IOException {
		if( arg == null || arg.size() == 0 || arg.get(0) == null){
			return null;
		}
		
		String loc = (String)arg.get(0);
		String l;
		if( loc.length() >= 2 ){
			l = map.get(loc.substring(0, 2));
			if( l != null ) return l;
		}
		if( loc.length() >= 3 ){
			l = map.get(loc.substring(0, 3));
			if( l != null ) return l;
		}
		if( loc.length() >= 4 ){
			l = map.get(loc.substring(0, 4));
			if( l != null ) return l;
		}
		return null;
	}
	
	public final static Map<String, String> map = new HashMap<String, String>() {
		private static final long serialVersionUID = 1L;

	{
		put("北京", "北京");
		put("上海", "上海");
		put("天津", "天津");
		put("重庆", "重庆");
		put("河北", "河北");
		put("石家庄", "河北");
		put("张家口", "河北");
		put("承德", "河北");
		put("唐山", "河北");
		put("秦皇岛", "河北");
		put("廊坊", "河北");
		put("保定", "河北");
		put("沧州", "河北");
		put("衡水", "河北");
		put("邢台", "河北");
		put("邯郸", "河北");
		put("山西", "山西");
		put("太原", "山西");
		put("大同", "山西");
		put("朔州", "山西");
		put("忻州", "山西");
		put("阳泉", "山西");
		put("晋中", "山西");
		put("吕梁", "山西");
		put("长治", "山西");
		put("临汾", "山西");
		put("晋城", "山西");
		put("运城", "山西");
		put("内蒙", "内蒙");
		put("呼和浩特", "内蒙");
		put("呼伦贝尔", "内蒙");
		put("通辽", "内蒙");
		put("赤峰", "内蒙");
		put("巴彦淖尔", "内蒙");
		put("乌兰察布", "内蒙");
		put("包头", "内蒙");
		put("鄂尔多斯", "内蒙");
		put("乌海", "内蒙");
		put("阿拉善", "内蒙");
		put("锡林郭勒", "内蒙");
		put("兴安", "内蒙");
		put("黑龙江", "黑龙江");
		put("哈尔滨", "黑龙江");
		put("黑河", "黑龙江");
		put("伊春", "黑龙江");
		put("齐齐哈尔", "黑龙江");
		put("鹤岗", "黑龙江");
		put("佳木斯", "黑龙江");
		put("双鸭山", "黑龙江");
		put("绥化", "黑龙江");
		put("大庆", "黑龙江");
		put("七台河", "黑龙江");
		put("鸡西", "黑龙江");
		put("牡丹江", "黑龙江");
		put("大兴安岭", "黑龙江");
		put("长春", "吉林");
		put("白城", "吉林");
		put("松原", "吉林");
		put("吉林", "吉林");
		put("四平", "吉林");
		put("辽源", "吉林");
		put("白山", "吉林");
		put("通化", "吉林");
		put("延边", "吉林");
		put("辽宁", "辽宁");
		put("沈阳", "辽宁");
		put("铁岭", "辽宁");
		put("阜新", "辽宁");
		put("抚顺", "辽宁");
		put("朝阳", "辽宁");
		put("本溪", "辽宁");
		put("辽阳", "辽宁");
		put("鞍山", "辽宁");
		put("盘锦", "辽宁");
		put("锦州", "辽宁");
		put("葫芦岛", "辽宁");
		put("营口", "辽宁");
		put("丹东", "辽宁");
		put("大连", "辽宁");
		put("江苏", "江苏");
		put("南京", "江苏");
		put("连云港", "江苏");
		put("徐州", "江苏");
		put("宿迁", "江苏");
		put("淮安", "江苏");
		put("盐城", "江苏");
		put("泰州", "江苏");
		put("扬州", "江苏");
		put("镇江", "江苏");
		put("南通", "江苏");
		put("常州", "江苏");
		put("无锡", "江苏");
		put("苏州", "江苏");
		put("浙江", "浙江");
		put("杭州", "浙江");
		put("湖州", "浙江");
		put("嘉兴", "浙江");
		put("绍兴", "浙江");
		put("舟山", "浙江");
		put("宁波", "浙江");
		put("金华", "浙江");
		put("衢州", "浙江");
		put("台州", "浙江");
		put("丽水", "浙江");
		put("温州", "浙江");
		put("安徽", "安徽");
		put("合肥", "安徽");
		put("淮北", "安徽");
		put("亳州", "安徽");
		put("宿州", "安徽");
		put("蚌埠", "安徽");
		put("阜阳", "安徽");
		put("淮南", "安徽");
		put("滁州", "安徽");
		put("六安", "安徽");
		put("马鞍山", "安徽");
		put("芜湖", "安徽");
		put("宣城", "安徽");
		put("铜陵", "安徽");
		put("池州", "安徽");
		put("安庆", "安徽");
		put("黄山", "安徽");
		put("福建", "福建");
		put("福州", "福建");
		put("宁德", "福建");
		put("南平", "福建");
		put("三明", "福建");
		put("莆田", "福建");
		put("龙岩", "福建");
		put("泉州", "福建");
		put("漳州", "福建");
		put("厦门", "福建");
		put("江西", "江西");
		put("南昌", "江西");
		put("九江", "江西");
		put("景德镇", "江西");
		put("上饶", "江西");
		put("鹰潭", "江西");
		put("抚州", "江西");
		put("新余", "江西");
		put("宜春", "江西");
		put("萍乡", "江西");
		put("吉安", "江西");
		put("赣州", "江西");
		put("山东", "山东");
		put("济南", "山东");
		put("德州", "山东");
		put("滨州", "山东");
		put("东营", "山东");
		put("烟台", "山东");
		put("威海", "山东");
		put("淄博", "山东");
		put("潍坊", "山东");
		put("聊城", "山东");
		put("泰安", "山东");
		put("莱芜", "山东");
		put("青岛", "山东");
		put("日照", "山东");
		put("济宁", "山东");
		put("菏泽", "山东");
		put("临沂", "山东");
		put("枣庄", "山东");
		put("河南", "河南");
		put("郑州", "河南");
		put("安阳", "河南");
		put("鹤壁", "河南");
		put("濮阳", "河南");
		put("新乡", "河南");
		put("焦作", "河南");
		put("三门峡", "河南");
		put("开封", "河南");
		put("洛阳", "河南");
		put("商丘", "河南");
		put("许昌", "河南");
		put("平顶山", "河南");
		put("周口", "河南");
		put("漯河", "河南");
		put("南阳", "河南");
		put("驻马店", "河南");
		put("信阳", "河南");
		put("湖北", "湖北");
		put("武汉", "湖北");
		put("十堰", "湖北");
		put("襄樊", "湖北");
		put("随州", "湖北");
		put("荆门", "湖北");
		put("孝感", "湖北");
		put("宜昌", "湖北");
		put("黄冈", "湖北");
		put("鄂州", "湖北");
		put("荆州", "湖北");
		put("黄石", "湖北");
		put("咸宁", "湖北");
		put("恩施", "湖北");
		put("湖南", "湖南");
		put("长沙", "湖南");
		put("岳阳", "湖南");
		put("张家界", "湖南");
		put("常德", "湖南");
		put("益阳", "湖南");
		put("湘潭", "湖南");
		put("株洲", "湖南");
		put("娄底", "湖南");
		put("怀化", "湖南");
		put("邵阳", "湖南");
		put("衡阳", "湖南");
		put("永州", "湖南");
		put("郴州", "湖南");
		put("湘西", "湖南");
		put("广东", "广东");
		put("广州", "广东");
		put("韶关", "广东");
		put("梅州", "广东");
		put("河源", "广东");
		put("清远", "广东");
		put("潮州", "广东");
		put("揭阳", "广东");
		put("汕头", "广东");
		put("肇庆", "广东");
		put("惠州", "广东");
		put("佛山", "广东");
		put("东莞", "广东");
		put("云浮", "广东");
		put("汕尾", "广东");
		put("江门", "广东");
		put("中山", "广东");
		put("深圳", "广东");
		put("珠海", "广东");
		put("阳江", "广东");
		put("茂名", "广东");
		put("湛江", "广东");
		put("广西", "广西");
		put("南宁", "广西");
		put("桂林", "广西");
		put("河池", "广西");
		put("贺州", "广西");
		put("柳州", "广西");
		put("百色", "广西");
		put("来宾", "广西");
		put("梧州", "广西");
		put("贵港", "广西");
		put("玉林", "广西");
		put("崇左", "广西");
		put("钦州", "广西");
		put("防城港", "广西");
		put("北海", "广西");
		put("海南", "海南");
		put("海口", "海南");
		put("三沙", "海南");
		put("三亚", "海南");
		put("四川", "四川");
		put("成都", "四川");
		put("广元", "四川");
		put("巴中", "四川");
		put("绵阳", "四川");
		put("德阳", "四川");
		put("达州", "四川");
		put("南充", "四川");
		put("遂宁", "四川");
		put("广安", "四川");
		put("资阳", "四川");
		put("眉山", "四川");
		put("雅安", "四川");
		put("内江", "四川");
		put("乐山", "四川");
		put("自贡", "四川");
		put("泸州", "四川");
		put("宜宾", "四川");
		put("攀枝花", "四川");
		put("凉山", "四川");
		put("阿坝", "四川");
		put("甘孜", "四川");
		put("贵州", "贵州");
		put("贵阳", "贵州");
		put("遵义", "贵州");
		put("六盘水", "贵州");
		put("安顺", "贵州");
		put("毕节", "贵州");
		put("铜仁", "贵州");
		put("黔西南", "贵州");
		put("黔南", "贵州");
		put("黔东南", "贵州");
		put("云南", "云南");
		put("昆明", "云南");
		put("昭通", "云南");
		put("丽江", "云南");
		put("曲靖", "云南");
		put("保山", "云南");
		put("玉溪", "云南");
		put("临沧", "云南");
		put("普洱", "云南");
		put("迪庆", "云南");
		put("楚雄", "云南");
		put("红河", "云南");
		put("西双版纳", "云南");
		put("大理", "云南");
		put("德宏", "云南");
		put("怒江", "云南");
		put("文山", "云南");
		put("西藏", "西藏");
		put("拉萨", "西藏");
		put("昌都", "西藏");
		put("日喀则", "西藏");
		put("林芝", "西藏");
		put("阿里", "西藏");
		put("山南", "西藏");
		put("那曲", "西藏");
		put("陕西", "陕西");
		put("西安", "陕西");
		put("榆林", "陕西");
		put("延安", "陕西");
		put("铜川", "陕西");
		put("渭南", "陕西");
		put("宝鸡", "陕西");
		put("咸阳", "陕西");
		put("商洛", "陕西");
		put("汉中", "陕西");
		put("安康", "陕西");
		put("甘肃", "甘肃");
		put("兰州", "甘肃");
		put("嘉峪关", "甘肃");
		put("酒泉", "甘肃");
		put("张掖", "甘肃");
		put("金昌", "甘肃");
		put("武威", "甘肃");
		put("白银", "甘肃");
		put("庆阳", "甘肃");
		put("平凉", "甘肃");
		put("定西", "甘肃");
		put("天水", "甘肃");
		put("陇南", "甘肃");
		put("甘南", "甘肃");
		put("临夏", "甘肃");
		put("青海", "青海");
		put("西宁", "青海");
		put("海东", "青海");
		put("海北", "青海");
		put("黄南", "青海");
		put("海南", "青海");
		put("海西", "青海");
		put("果洛", "青海");
		put("玉树", "青海");
		put("宁夏", "宁夏");
		put("银川", "宁夏");
		put("石嘴山", "宁夏");
		put("吴忠", "宁夏");
		put("中卫", "宁夏");
		put("固原", "宁夏");
		put("新疆", "新疆");
		put("乌鲁木齐", "新疆");
		put("克拉玛依", "新疆");
		put("吐鲁番", "新疆");
		put("哈密", "新疆");
		put("阿克苏", "新疆");
		put("塔城", "新疆");
		put("阿勒泰", "新疆");
		put("喀什", "新疆");
		put("和田", "新疆");
		put("伊犁", "新疆");
		put("昌吉", "新疆");
		put("巴音郭楞", "新疆");
		put("巴州", "新疆");
		put("博尔塔拉", "新疆");
		put("博州", "新疆");
		put("克孜勒苏", "新疆");
		put("克州", "新疆");
		put("台湾", "台湾");
		put("台北", "台湾");
		put("高雄", "台湾");
		put("香港", "香港");
		put("澳门", "澳门");
	}};
}
